from django.db import models

# Create your models here.

class GeneralWebExploit(models.Model):
    exploit_name = models.CharField(max_length=200)
    author       = models.CharField(max_length=200)
    creat_date     = models.DateTimeField('creation published')
    exploit_type = models.CharField(max_length=200)
    exploit_code = models.TextField()
    RCE = 'RCE'
    RFI = 'RFI'
    LFI = 'LFI'
    LFD = 'LFD'
    SQL = 'SQL'
    ID  = 'ID'
    exploit_type_choices = (
        (RCE, 'Remote Code Execution'),
        (LFI, 'Local File Inclusion'),
        (RFI, 'Remote File Inclusion'),
        (LFD, 'Local File Disclosure'),
        (SQL, 'SQL Injection'),
        (ID, 'Information Disclosure'),
    )
    exploit_type = models.CharField(max_length=3,
                                      choices=exploit_type_choices,
                                      default=RCE)

    # On Python 3: def __str__(self):
    def __unicode__(self):
        return self.exploit_name
    

class WordpressExploit(models.Model):
    author   = models.CharField(max_length=200)
    pub_date = models.DateTimeField('date published')

class JoomlaExploit(models.Model):
    #wp_exploit = models.ForeignKey(Exploit)
    choice_text = models.CharField(max_length=200)
    votes = models.IntegerField(default=0)
